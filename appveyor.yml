# See http://www.appveyor.com/docs/appveyor-yml for many more options

version: 0.0.{build}

cache:
- C:\ProgramData\chocolatey\bin -> appveyor.yml
- C:\ProgramData\chocolatey\lib -> appveyor.yml
- C:\Program Files\WindowsPowerShell\Modules\PSScriptAnalyzer -> appveyor.yml
- C:\Program Files\WindowsPowerShell\Modules\Pester -> appveyor.yml
- C:\Program Files\WindowsPowerShell\Modules\PSFramework -> appveyor.yml

shallow_clone: true
  
environment: 
  environment: master
  version: 0.0.$(appveyor_build_number)
  sponlinecred:
    secure: S6wQnBeB5UVjpkNwlU0sSQ==

matrix:
  fast_finish: true
  
# Set alternative clone folder
clone_folder: C:\github\SPReplicator

build_script:
# grab appveyor lab files and needed requirements for tests in CI
- ps: .\Tests\appveyor.prep.ps1

#- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

test_script:
# Test with native PS version
- ps: .\Tests\appveyor.pester.ps1

# Collecting results
- ps: .\Tests\appveyor.pester.ps1 -Finalize

#after_test:
#- ps: .\Tests\appveyor.post.ps1

#on_finish:
#  - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
